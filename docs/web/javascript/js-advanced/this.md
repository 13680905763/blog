# this

- 函数在调用时，JavaScript 会默认给 this 绑定一个值；
- this 的绑定和定义的位置（编写的位置）没有关系；
- this 的绑定和调用方式以及调用的位置有关系；
- this 是在运行时被绑定的；

this 的绑定规则

- 默认绑定；
- 隐式绑定；
- 显示绑定；
- new 绑定；

## 默认绑定

独立的函数调用

## 隐式绑定

通过某个对象进行调用

创建一个函数的 间接引用，这种情况使用默认绑定规则

```javascript
;(obj2.foo = obj1.foo)()
```

## 显式绑定

- JavaScript 所有的函数都可以使用 call 和 apply 方法。
  - 第一个参数是相同的，要求传入一个对象；
    - 这个对象的作用是什么呢？就是给 this 准备的。
    - 在调用这个函数时，会将 this 绑定到这个传入的对象上。
  - 后面的参数，apply 为数组，call 为参数列表；
    - 因为上面的过程，我们明确的绑定了 this 指向的对象，所以称之为 显式绑定。

如果传入一个 null 或者 undefined，那么这个显示绑定会被忽略，使用默认规则

### bind

- 一个函数总是显示的绑定到一个对象上
   使用 bind 方法，bind() 方法创建一个新的绑定函数（bound function，BF）；
   绑定函数是一个 exotic function object（怪异函数对象，ECMAScript 2015 中的术语）
   在 bind() 被调用时，这个新函数的 this 被指定为 bind() 的第一个参数，而其余参数将作为新函数的参数，供调用时使用。

## new 绑定

- JavaScript 中的函数可以当做一个类的构造函数来使用，也就是使用 new 关键字。
- 使用 new 关键字来调用函数是，会执行如下的操作：
  1. 创建一个全新的对象；
  2. 这个新对象会被执行 prototype 连接；
  3. 这个新对象会绑定到函数调用的 this 上（this 的绑定在这个步骤完成）；
  4. 如果函数没有返回其他对象，表达式会返回这个新对象；

## 规则优先级

1. 默认规则的优先级最低
2. 显示绑定优先级高于隐式绑定
3. new 绑定优先级高于隐式绑定
4. new 绑定优先级高于 bind
   - new 绑定和 call、apply 是不允许同时使用的，所以不存在谁的优先级更高
   - new 绑定可以和 bind 一起使用，new 绑定优先级更高

## 箭头函数

- 箭头函数不会绑定 this、arguments 属性；
- 箭头函数不能作为构造函数来使用（不能和 new 一起来使用，会抛出错误）；

根据外层作用域来决定 this
